function xyz=my_rgb2xyz(rgb,M)

%http://www.brucelindbloom.com/index.html?Eqn_RGB_XYZ_Matrix.html
%   Bruce RGB->XYZ
%     M=[ 0.4674162  0.2944512  0.1886026
%      0.2410115  0.6835475  0.0754410
%      0.0219101  0.0736128  0.9933071];

% sRGB->XYZ
% use this
%  M=[	
%  0.4124564  0.3575761  0.1804375
%  0.2126729  0.7151522  0.0721750
%  0.0193339  0.1191920  0.9503041];

% M=[0.433953    0.376219    0.189828
%     0.212671    0.715160    0.072169
%     0.017758    0.109477    0.872765];
if nargin == 1
    M=[	
     0.4124564  0.3575761  0.1804375
     0.2126729  0.7151522  0.0721750
     0.0193339  0.1191920  0.9503041];
end
rgb=rgb(:);
xyz=M*rgb;
xyz=xyz';
end